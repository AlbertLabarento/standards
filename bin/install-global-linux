#!/bin/bash

#---- Configuration ----#
NAME=standards
ORIGINAL_DIR=$(dirname ${0})
ORIGINAL=${ORIGINAL_DIR}/${NAME}
TARGET_DIR=/usr/local/bin
TARGET=${TARGET_DIR}/${NAME}

#---- Functions ----#
# Echo given message in red
echoError () {
    echo -e "\033[0;91m${1}\033[m"
}

# Echo given message in yellow
echoInfo () {
    echo -e "\033[0;93m${1}\033[m"
}

# Run given command, echo in red the result if error otherwise echo given success message
# ${1} = command to run
# ${2} = message to echo on success
echoOnSuccess () {
    result=$(${1})

    if [ ${?} -ne 0 ]; then
        echoError ${result}
        exit 1
    else
        echo -e ${2}
    fi
}

#---- Logic ----#
# Create target dir if doesn't exist
if ! [ -d ${TARGET_DIR} ]; then
    echoInfo "Creating ${TARGET_DIR}"
    echoOnSuccess "mkdir ${TARGET_DIR}" "${TARGET_DIR} created"
fi

# Abort install if target already exists
if [ -L ${TARGET} ] || [ -e ${TARGET} ]; then
    echoError "${TARGET} already exists. Abort..."
    exit 1
fi

# Create symlink
echoInfo "Creating symlink for ${ORIGINAL} to ${TARGET}"
echoOnSuccess "ln -s  ${ORIGINAL} ${TARGET}" "You can now use \033[0;92m standards [options] \033[m wherever you want."
